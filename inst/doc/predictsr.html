<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to predictsr</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to predictsr</h1>



<p>The <a href="https://github.com/Biodiversity-Futures-Lab/predictsr"><code>predictsr</code></a>
package accesses the PREDICTS database (Hudson et al, 2013) from within
R, conveniently as a dataframe. It uses the <a href="https://data.nhm.ac.uk/">Natural History Museum Data Portal</a> to
download the latest versions of the PREDICTS database and some related
metadata.</p>
<p>The <a href="https://www.nhm.ac.uk/our-science/research/projects/predicts/science.html">PREDICTS</a>
database comprises over 4 million measurements of species at sites
across the world. All major terrestrial plant, animal, and fungal groups
are represented within the data. The most well-represented group in the
data are arthropods (mainly insects), covering about 2% of the species
known by science</p>
<p>There have been 2 public releases of PREDICTS data. The first was in
<a href="https://data.nhm.ac.uk/dataset/the-2016-release-of-the-predicts-database-v1-1">2016</a>
and the second was in <a href="https://data.nhm.ac.uk/dataset/release-of-data-added-to-the-predicts-database-november-2022">2022</a>;
each consisted of about 3 million and 1 million records, respectively.
We include both, as a single dataset, in this package.</p>
<p><em>However</em>, the PREDICTS database is under constant development
and is continuously growing, with later releases planned.</p>
<p>To get started, let’s load in the database into R and poke around. To
do so you will use the <code>GetPredictsData</code> function, which
pulls in the data from the data portal. I’ll repeat the default option
below, but you can take either 2016, 2022, or both as the extracts to
fetch. It reads in both extracts into a single dataframe:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>predicts <span class="ot">&lt;-</span> predictsr<span class="sc">::</span><span class="fu">GetPredictsData</span>(<span class="at">extract =</span> <span class="fu">c</span>(<span class="dv">2016</span>, <span class="dv">2022</span>))</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">str</span>(predicts)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4318808 obs. of  67 variables:
##  $ Source_ID                              : Factor w/ 708 levels &quot;AD1_2001__Liow&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Reference                              : Factor w/ 605 levels &quot;Aben et al. 2008&quot;,..: 250 250 250 250 250 250 250 250 250 250 ...
##  $ Study_number                           : int  1 1 1 1 1 2 2 2 2 2 ...
##  $ Study_name                             : Factor w/ 888 levels &quot;1 Western Ghat&quot;,..: 748 748 748 748 748 749 749 749 749 749 ...
##  $ SS                                     : Factor w/ 993 levels &quot;AD1_2001__Liow 1&quot;,..: 1 1 1 1 1 2 2 2 2 2 ...
##  $ Diversity_metric                       : Factor w/ 15 levels &quot;abundance&quot;,&quot;biomass&quot;,..: 1 1 1 1 1 15 15 15 15 15 ...
##  $ Diversity_metric_unit                  : Factor w/ 29 levels &quot;effort-corrected individuals&quot;,..: 6 6 6 6 6 18 18 18 18 18 ...
##  $ Diversity_metric_type                  : Factor w/ 3 levels &quot;Abundance&quot;,&quot;Occurrence&quot;,..: 1 1 1 1 1 3 3 3 3 3 ...
##  $ Diversity_metric_is_effort_sensitive   : logi  TRUE TRUE TRUE TRUE TRUE FALSE ...
##  $ Diversity_metric_is_suitable_for_Chao  : logi  TRUE TRUE TRUE TRUE TRUE FALSE ...
##  $ Sampling_method                        : Factor w/ 73 levels &quot;accoustic encounter transect&quot;,..: 64 64 64 64 64 64 64 64 64 64 ...
##  $ Sampling_effort_unit                   : Factor w/ 29 levels &quot;catch&quot;,&quot;core&quot;,..: 21 21 21 21 21 21 21 21 21 21 ...
##  $ Study_common_taxon                     : Factor w/ 97 levels &quot;&quot;,&quot;Acrididae&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ Rank_of_study_common_taxon             : Factor w/ 9 levels &quot;&quot;,&quot;Infraspecies&quot;,..: 5 5 5 5 5 5 5 5 5 5 ...
##  $ Site_number                            : int  1 2 3 4 5 1 2 3 4 5 ...
##  $ Site_name                              : Factor w/ 33356 levels &quot;0&quot;,&quot;003_HEM_2&quot;,..: 7452 20011 22227 14654 17746 7452 20011 22227 14654 17746 ...
##  $ Block                                  : Factor w/ 2129 levels &quot;&quot;,&quot;0&quot;,&quot;01.07.2007&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ SSS                                    : Factor w/ 50032 levels &quot;AD1_2001__Liow 1 1&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ SSB                                    : Factor w/ 6098 levels &quot;AD1_2001__Liow 1 &quot;,..: 1 1 1 1 1 2 2 2 2 2 ...
##  $ SSBS                                   : Factor w/ 50032 levels &quot;AD1_2001__Liow 1  1&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Sample_start_earliest                  : Date, format: &quot;1999-03-03&quot; &quot;1999-02-24&quot; ...
##  $ Sample_end_latest                      : Date, format: &quot;1999-06-30&quot; &quot;1999-06-24&quot; ...
##  $ Sample_midpoint                        : Date, format: &quot;1999-05-01&quot; &quot;1999-04-25&quot; ...
##  $ Sample_date_resolution                 : Factor w/ 3 levels &quot;day&quot;,&quot;month&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Max_linear_extent_metres               : num  3000 3000 3000 1800 2000 3000 3000 3000 1800 2000 ...
##  $ Habitat_patch_area_square_metres       : num  870000 5210000 7946000 415000 272000 ...
##  $ Sampling_effort                        : num  30 30 30 18 20 30 30 30 18 20 ...
##  $ Rescaled_sampling_effort               : num  1 1 1 0.6 0.667 ...
##  $ Habitat_as_described                   : Factor w/ 3155 levels &quot;&quot;,&quot;010 WETLAND&quot;,..: 2141 2458 2458 2447 2432 2141 2458 2458 2447 2432 ...
##  $ Predominant_land_use                   : Factor w/ 10 levels &quot;Primary vegetation&quot;,..: 1 4 4 3 3 1 4 4 3 3 ...
##  $ Source_for_predominant_land_use        : Factor w/ 4 levels &quot;&quot;,&quot;Direct from publication / author&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Use_intensity                          : Factor w/ 4 levels &quot;Minimal use&quot;,..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ Km_to_nearest_edge_of_habitat          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ Years_since_fragmentation_or_conversion: num  NA 70 70 30 30 NA 70 70 30 30 ...
##  $ Transect_details                       : Factor w/ 506 levels &quot;&quot;,&quot;100m&quot;,&quot;100m*2&amp;300m*1&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Coordinates_method                     : Factor w/ 2 levels &quot;Direct from publication / author&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Longitude                              : num  104 104 104 104 104 ...
##  $ Latitude                               : num  1.35 1.35 1.39 1.33 1.28 ...
##  $ Country_distance_metres                : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ Country                                : Factor w/ 246 levels &quot;Afghanistan&quot;,..: 199 199 199 199 199 199 199 199 199 199 ...
##  $ UN_subregion                           : Factor w/ 23 levels &quot;Australia and New Zealand&quot;,..: 17 17 17 17 17 17 17 17 17 17 ...
##  $ UN_region                              : Factor w/ 6 levels &quot;Africa&quot;,&quot;Americas&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ Ecoregion_distance_metres              : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ Ecoregion                              : Factor w/ 814 levels &quot;Admiralty Islands Lowland Rain Forests&quot;,..: 548 548 548 548 548 548 548 548 548 548 ...
##  $ Biome                                  : Factor w/ 16 levels &quot;Tundra&quot;,&quot;Boreal Forests/Taiga&quot;,..: 13 13 13 13 13 13 13 13 13 13 ...
##  $ Realm                                  : Factor w/ 8 levels &quot;Afrotropic&quot;,&quot;Antarctic&quot;,..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ Hotspot                                : Factor w/ 36 levels &quot;&quot;,&quot;Atlantic Forest&quot;,..: 32 32 32 32 32 32 32 32 32 32 ...
##  $ Wilderness_area                        : Factor w/ 6 levels &quot;&quot;,&quot;Amazonia&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Taxon_number                           : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ Taxon_name_entered                     : Factor w/ 60997 levels &quot;1&quot;,&quot;10&quot;,&quot;100&quot;,..: 7029 7029 7029 7029 7029 7029 7029 7029 7029 7029 ...
##  $ Indication                             : Factor w/ 2134 levels &quot;&quot;,&quot;???&quot;,&quot;aardvark&quot;,..: 995 995 995 995 995 995 995 995 995 995 ...
##  $ Parsed_name                            : Factor w/ 48443 levels &quot;&quot;,&quot;a&quot;,&quot;A100_Eumenidae&quot;,..: 5498 5498 5498 5498 5498 5498 5498 5498 5498 5498 ...
##  $ Taxon                                  : Factor w/ 29585 levels &quot;&quot;,&quot;Abacoproeces saltuum&quot;,..: 2167 2167 2167 2167 2167 2167 2167 2167 2167 2167 ...
##  $ COL_ID                                 : int  13025340 13025340 13025340 13025340 13025340 13025340 13025340 13025340 13025340 13025340 ...
##  $ Name_status                            : Factor w/ 3 levels &quot;&quot;,&quot;accepted name&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Rank                                   : Factor w/ 9 levels &quot;&quot;,&quot;Infraspecies&quot;,..: 5 5 5 5 5 5 5 5 5 5 ...
##  $ Kingdom                                : Factor w/ 5 levels &quot;&quot;,&quot;Animalia&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Phylum                                 : Factor w/ 14 levels &quot;&quot;,&quot;Annelida&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ Class                                  : Factor w/ 53 levels &quot;&quot;,&quot;Actinopterygii&quot;,..: 25 25 25 25 25 25 25 25 25 25 ...
##  $ Order                                  : Factor w/ 291 levels &quot;&quot;,&quot;Acarosporales&quot;,..: 128 128 128 128 128 128 128 128 128 128 ...
##  $ Family                                 : Factor w/ 1652 levels &quot;&quot;,&quot;Abrocomidae&quot;,..: 98 98 98 98 98 98 98 98 98 98 ...
##  $ Genus                                  : Factor w/ 10606 levels &quot;&quot;,&quot;Abacoproeces&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Species                                : Factor w/ 14093 levels &quot;&quot;,&quot;abalinealis&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Best_guess_binomial                    : Factor w/ 36312 levels &quot;&quot;,&quot;Abacoproeces saltuum&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Higher_taxon                           : Factor w/ 63 levels &quot;&quot;,&quot;Actinopterygii&quot;,..: 26 26 26 26 26 26 26 26 26 26 ...
##  $ Measurement                            : num  42 242 232 111 63 5 22 5 9 10 ...
##  $ Effort_corrected_measurement           : num  42 242 232 185 94.5 5 22 5 9 10 ...</code></pre>
<p>Be patient as this may take a few seconds to run, as it downloads the
data from the NHM Data Portal.</p>
<p>So we can see that there are over 4 million records in the combined
PREDICTS extracts. Let’s look at a set of summary statistics for the
database:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(predicts) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  taxa <span class="ot">&lt;-</span> predicts[</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">duplicated</span>(predicts[, <span class="fu">c</span>(<span class="st">&quot;Source_ID&quot;</span>, <span class="st">&quot;Study_name&quot;</span>, <span class="st">&quot;Taxon_name_entered&quot;</span>)]),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  ]</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  species_counts <span class="ot">&lt;-</span> <span class="fu">length</span>(</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="fu">unique</span>(taxa[taxa<span class="sc">$</span>Rank <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Species&quot;</span>, <span class="st">&quot;Infraspecies&quot;</span>), <span class="st">&quot;Taxon&quot;</span>])</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  ) <span class="sc">+</span>  <span class="fu">nrow</span>(taxa[<span class="sc">!</span>taxa<span class="sc">$</span>Rank <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Species&quot;</span>, <span class="st">&quot;Infraspecies&quot;</span>), ])</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="st">&quot;This database has {length(unique(predicts$SS))} studies across &quot;</span>,</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="st">&quot;{length(unique(predicts$SSBS))} sites, in &quot;</span>,</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>    <span class="st">&quot;{length(unique(predicts$Country))} countries, and with &quot;</span>,</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="st">&quot;{species_counts} species.&quot;</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  ))</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;No data available - check the download!&quot;</span>)</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## This database has 817 studies across 35736 sites, in 101 countries, and with 54863 species.</code></pre>
<p>So over 30,000 sites, 101 countries, and 12,892 species in this
dataframe! There are a couple of important columns that should be noted.
The <code>SS</code> column is what we use to identify studies when
dealing with PREDICTS data. This is the concantenation of the
<code>Source_ID</code>, and the <code>Study_number</code> columns.
Another important identifier is the <code>SBBS</code>, the concatenation
of <code>Source_ID</code>, <code>Study_number</code>, <code>Block</code>
and <code>Site_number</code>, which is what we use to identify single
sites in the database.</p>
<p>Let’s also check the ranges of sample collection in the database:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(predicts) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="st">&quot;Earliest sample collection (midpoint): {min(predicts$Sample_midpoint)}, &quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="st">&quot;latest sample collection (midpoint): {max(predicts$Sample_midpoint)}&quot;</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  ))</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;No data available in the PREDICTS database - check the download!&quot;</span>)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Earliest sample collection (midpoint): 1984-04-22, latest sample collection (midpoint): 2018-05-01</code></pre>
<div id="accessing-site-level-summaries" class="section level2">
<h2>Accessing site-level summaries</h2>
<p>We also include access to the site-level summaries from the full
release; to get <em>these data</em> you will need to use the
<code>GetSitelevelSummaries</code> function. The function call is very
similar to pull in the summaries for the same data as above:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>summaries <span class="ot">&lt;-</span> predictsr<span class="sc">::</span><span class="fu">GetSitelevelSummaries</span>(<span class="at">extract =</span> <span class="fu">c</span>(<span class="dv">2016</span>, <span class="dv">2022</span>))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">str</span>(summaries)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    35738 obs. of  50 variables:
##  $ Source_ID                              : Factor w/ 707 levels &quot;AD1_2001__Liow&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Reference                              : Factor w/ 605 levels &quot;Aben et al. 2008&quot;,..: 250 250 250 250 250 250 250 250 250 250 ...
##  $ Study_number                           : int  1 1 1 1 1 2 2 2 2 2 ...
##  $ Study_name                             : Factor w/ 888 levels &quot;1 Western Ghat&quot;,..: 748 748 748 748 748 749 749 749 749 749 ...
##  $ SS                                     : Factor w/ 993 levels &quot;AD1_2001__Liow 1&quot;,..: 1 1 1 1 1 2 2 2 2 2 ...
##  $ Diversity_metric                       : Factor w/ 15 levels &quot;abundance&quot;,&quot;biomass&quot;,..: 1 1 1 1 1 15 15 15 15 15 ...
##  $ Diversity_metric_unit                  : Factor w/ 29 levels &quot;effort-corrected individuals&quot;,..: 6 6 6 6 6 18 18 18 18 18 ...
##  $ Diversity_metric_type                  : Factor w/ 3 levels &quot;Abundance&quot;,&quot;Occurrence&quot;,..: 1 1 1 1 1 3 3 3 3 3 ...
##  $ Diversity_metric_is_effort_sensitive   : logi  TRUE TRUE TRUE TRUE TRUE FALSE ...
##  $ Diversity_metric_is_suitable_for_Chao  : logi  TRUE TRUE TRUE TRUE TRUE FALSE ...
##  $ Sampling_method                        : Factor w/ 73 levels &quot;accoustic encounter transect&quot;,..: 64 64 64 64 64 64 64 64 64 64 ...
##  $ Sampling_effort_unit                   : Factor w/ 29 levels &quot;catch&quot;,&quot;core&quot;,..: 21 21 21 21 21 21 21 21 21 21 ...
##  $ Study_common_taxon                     : Factor w/ 97 levels &quot;&quot;,&quot;Acrididae&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ Rank_of_study_common_taxon             : Factor w/ 9 levels &quot;&quot;,&quot;Infraspecies&quot;,..: 5 5 5 5 5 5 5 5 5 5 ...
##  $ Site_number                            : int  1 2 3 4 5 1 2 3 4 5 ...
##  $ Site_name                              : Factor w/ 33601 levels &quot;0&quot;,&quot;003_HEM_2&quot;,..: 7456 20074 22376 14658 17757 7456 20074 22376 14658 17757 ...
##  $ Block                                  : Factor w/ 2129 levels &quot;&quot;,&quot;0&quot;,&quot;01.07.2007&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ SSS                                    : Factor w/ 53008 levels &quot;AD1_2001__Liow 1 1&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ SSB                                    : Factor w/ 6113 levels &quot;AD1_2001__Liow 1 &quot;,..: 1 1 1 1 1 2 2 2 2 2 ...
##  $ SSBS                                   : Factor w/ 53008 levels &quot;AD1_2001__Liow 1  1&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Sample_start_earliest                  : Date, format: &quot;1999-03-03&quot; &quot;1999-02-24&quot; ...
##  $ Sample_end_latest                      : Date, format: &quot;1999-06-30&quot; &quot;1999-06-24&quot; ...
##  $ Sample_midpoint                        : Date, format: &quot;1999-05-01&quot; &quot;1999-04-25&quot; ...
##  $ Sample_date_resolution                 : Factor w/ 3 levels &quot;day&quot;,&quot;month&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Max_linear_extent_metres               : num  3000 3000 3000 1800 2000 3000 3000 3000 1800 2000 ...
##  $ Habitat_patch_area_square_metres       : num  870000 5210000 7946000 415000 272000 ...
##  $ Sampling_effort                        : num  30 30 30 18 20 30 30 30 18 20 ...
##  $ Rescaled_sampling_effort               : num  1 1 1 0.6 0.667 ...
##  $ Habitat_as_described                   : Factor w/ 3155 levels &quot;&quot;,&quot;010 WETLAND&quot;,..: 2141 2458 2458 2447 2432 2141 2458 2458 2447 2432 ...
##  $ Predominant_land_use                   : Factor w/ 10 levels &quot;Primary vegetation&quot;,..: 1 4 4 3 3 1 4 4 3 3 ...
##  $ Source_for_predominant_land_use        : Factor w/ 4 levels &quot;&quot;,&quot;Direct from publication / author&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Use_intensity                          : Factor w/ 4 levels &quot;Minimal use&quot;,..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ Km_to_nearest_edge_of_habitat          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ Years_since_fragmentation_or_conversion: num  NA 70 70 30 30 NA 70 70 30 30 ...
##  $ Transect_details                       : Factor w/ 506 levels &quot;&quot;,&quot;100m&quot;,&quot;100m*2&amp;300m*1&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Coordinates_method                     : Factor w/ 2 levels &quot;Direct from publication / author&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Longitude                              : num  104 104 104 104 104 ...
##  $ Latitude                               : num  1.35 1.35 1.39 1.33 1.28 ...
##  $ Country_distance_metres                : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ Country                                : Factor w/ 246 levels &quot;Afghanistan&quot;,..: 199 199 199 199 199 199 199 199 199 199 ...
##  $ UN_subregion                           : Factor w/ 23 levels &quot;Australia and New Zealand&quot;,..: 17 17 17 17 17 17 17 17 17 17 ...
##  $ UN_region                              : Factor w/ 6 levels &quot;Africa&quot;,&quot;Americas&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ Ecoregion_distance_metres              : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ Ecoregion                              : Factor w/ 814 levels &quot;Admiralty Islands Lowland Rain Forests&quot;,..: 548 548 548 548 548 548 548 548 548 548 ...
##  $ Biome                                  : Factor w/ 16 levels &quot;Tundra&quot;,&quot;Boreal Forests/Taiga&quot;,..: 13 13 13 13 13 13 13 13 13 13 ...
##  $ Realm                                  : Factor w/ 8 levels &quot;Afrotropic&quot;,&quot;Antarctic&quot;,..: 4 4 4 4 4 4 4 4 4 4 ...
##  $ Hotspot                                : Factor w/ 36 levels &quot;&quot;,&quot;Atlantic Forest&quot;,..: 32 32 32 32 32 32 32 32 32 32 ...
##  $ Wilderness_area                        : Factor w/ 6 levels &quot;&quot;,&quot;Amazonia&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ N_samples                              : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ Higher_taxa                            : chr  &quot;Hymenoptera&quot; &quot;Hymenoptera&quot; &quot;Hymenoptera&quot; &quot;Hymenoptera&quot; ...</code></pre>
<p>Investigating the summary data closer we see that there are a number
of missing columns between the two dataframes:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(predicts) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(summaries) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">names</span>(predicts)[<span class="sc">!</span>(<span class="fu">names</span>(predicts) <span class="sc">%in%</span> <span class="fu">names</span>(summaries))])</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>##  [1] &quot;Taxon_number&quot;                 &quot;Taxon_name_entered&quot;          
##  [3] &quot;Indication&quot;                   &quot;Parsed_name&quot;                 
##  [5] &quot;Taxon&quot;                        &quot;COL_ID&quot;                      
##  [7] &quot;Name_status&quot;                  &quot;Rank&quot;                        
##  [9] &quot;Kingdom&quot;                      &quot;Phylum&quot;                      
## [11] &quot;Class&quot;                        &quot;Order&quot;                       
## [13] &quot;Family&quot;                       &quot;Genus&quot;                       
## [15] &quot;Species&quot;                      &quot;Best_guess_binomial&quot;         
## [17] &quot;Higher_taxon&quot;                 &quot;Measurement&quot;                 
## [19] &quot;Effort_corrected_measurement&quot;</code></pre>
<p>This is because all of the measurement-level data has been dropped
from the dataframe. Now indeed we could try and replicate the creation
of the <code>summaries</code> dataframe through some {dplyr} operations.
These would be the following (roughly):</p>
<p><strong>Note:</strong> I’m not sure on the summary statistics for
this one, there seems to be some differences, and there are a couple
sites that don’t match up.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(summaries) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  summaries_rep <span class="ot">&lt;-</span> predicts <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>      <span class="at">Higher_taxa =</span> <span class="fu">paste</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(Higher_taxon)), <span class="at">collapse =</span> <span class="st">&quot;,&quot;</span>),</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>      <span class="at">N_samples =</span> <span class="fu">length</span>(Measurement),</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>      <span class="at">Rescaled_sampling_effort =</span> <span class="fu">mean</span>(Rescaled_sampling_effort),</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>      <span class="at">.by =</span> SSBS</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">all_of</span>(<span class="fu">names</span>(summaries))</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(SSBS)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>  </span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>  summaries_copy <span class="ot">&lt;-</span> summaries <span class="sc">|&gt;</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>    <span class="fu">subset</span>(SSBS <span class="sc">%in%</span> summaries_rep<span class="sc">$</span>SSBS) <span class="sc">|&gt;</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(SSBS)</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  </span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>  <span class="fu">all.equal</span>(summaries_copy, summaries_rep)</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>##  [1] &quot;Attributes: &lt; Component \&quot;row.names\&quot;: 35719 string mismatches &gt;&quot;                                                            
##  [2] &quot;Component \&quot;Source_ID\&quot;: Attributes: &lt; Component \&quot;levels\&quot;: Lengths (707, 708) differ (string compare on first 707) &gt;&quot;      
##  [3] &quot;Component \&quot;Study_common_taxon\&quot;: 1905 string mismatches&quot;                                                                    
##  [4] &quot;Component \&quot;Rank_of_study_common_taxon\&quot;: 1254 string mismatches&quot;                                                            
##  [5] &quot;Component \&quot;Site_name\&quot;: Attributes: &lt; Component \&quot;levels\&quot;: Lengths (33601, 33356) differ (string compare on first 33356) &gt;&quot;
##  [6] &quot;Component \&quot;Site_name\&quot;: Attributes: &lt; Component \&quot;levels\&quot;: 27521 string mismatches &gt;&quot;                                      
##  [7] &quot;Component \&quot;SSS\&quot;: Attributes: &lt; Component \&quot;levels\&quot;: Lengths (53008, 50032) differ (string compare on first 50032) &gt;&quot;      
##  [8] &quot;Component \&quot;SSS\&quot;: Attributes: &lt; Component \&quot;levels\&quot;: 13977 string mismatches &gt;&quot;                                            
##  [9] &quot;Component \&quot;SSB\&quot;: Attributes: &lt; Component \&quot;levels\&quot;: Lengths (6113, 6098) differ (string compare on first 6098) &gt;&quot;         
## [10] &quot;Component \&quot;SSB\&quot;: Attributes: &lt; Component \&quot;levels\&quot;: 460 string mismatches &gt;&quot;                                              
## [11] &quot;Component \&quot;SSBS\&quot;: Attributes: &lt; Component \&quot;levels\&quot;: Lengths (53008, 50032) differ (string compare on first 50032) &gt;&quot;     
## [12] &quot;Component \&quot;SSBS\&quot;: Attributes: &lt; Component \&quot;levels\&quot;: 13977 string mismatches &gt;&quot;                                           
## [13] &quot;Component \&quot;Rescaled_sampling_effort\&quot;: Mean relative difference: 0.237503&quot;                                                  
## [14] &quot;Component \&quot;Higher_taxa\&quot;: 8399 string mismatches&quot;</code></pre>
</div>
<div id="accessing-descriptions-of-the-columns-in-predicts" class="section level2">
<h2>Accessing descriptions of the columns in PREDICTS</h2>
<p>As we’ve seen already, there are 67 (!) columns in the PREDICTS
database, and within the NHM Data portal releases, we have included a
description of the data that is used in each of these columns. You can
access this via the <code>GetColumnDescriptions</code> function:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>descriptions <span class="ot">&lt;-</span> predictsr<span class="sc">::</span><span class="fu">GetColumnDescriptions</span>()</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">str</span>(descriptions)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    69 obs. of  8 variables:
##  $ Column                          : chr  &quot;Source_ID&quot; &quot;Reference&quot; &quot;Study_number&quot; &quot;Study_name&quot; ...
##  $ Applies_to                      : chr  &quot;Data Source&quot; &quot;Data Source&quot; &quot;Study&quot; &quot;Study&quot; ...
##  $ Site_extract                    : chr  &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ Diversity_extract               : chr  &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ Type                            : chr  &quot;String&quot; &quot;String&quot; &quot;Integer&quot; &quot;String&quot; ...
##  $ Value_guaranteed_to_be_non_empty: chr  &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ Notes                           : chr  &quot;ID for the Data Source.&quot; &quot;Reference for the Data Source in the main text.&quot; &quot; &quot; &quot; &quot; ...
##  $ Validation                      : chr  &quot;Unique.&quot; &quot; &quot; &quot;Between 1 and n for n Studies within Data Source. Unique within Source_ID.&quot; &quot;Unique within Source_ID.&quot; ...</code></pre>
<p>So this includes the <code>Column</code> name, the resolution of the
<code>Column</code> (<code>Applies_to</code>), whether it is in the
PREDICTS extract (<code>Diversity_extract</code>), whether it is in the
site-level summaries (<code>Site_extract</code>), the datatype of the
<code>Column</code>*, whether it is guaranteed to be nonempty, any
additional <code>Notes</code>, and any information on the range of
values that the <code>Column</code> may be expected to take
(<code>Validation</code>).</p>
</div>
<div id="glossary" class="section level2">
<h2>Glossary</h2>
<p>To clarify some of the PREDICTS jargon, we include the following
table of definitions, from the dataframes we have worked with thus
far:</p>
<ul>
<li><code>Source_ID</code> (<code>String</code>): ID for the Data
Source.<br />
</li>
<li><code>SS</code> (<code>String</code>): Concatenation of Source_ID
and Study_number.<br />
</li>
<li><code>Diversity_metric_type</code> (<code>String</code>): One of:
<ul>
<li>Abundance<br />
</li>
<li>Occurrence<br />
</li>
<li>Species richness<br />
</li>
</ul></li>
<li><code>Block</code> (<code>Integer</code>): Within a Study either:
<ul>
<li>Empty for all Sites<br />
</li>
<li>Non-empty for all Sites and at least two different values among
Sites<br />
</li>
</ul></li>
<li><code>SSBS</code> (<code>String</code>): Concatenation of Source_ID,
Study_number, Block and Site_number.<br />
</li>
<li><code>Measurement</code> (<code>Number</code>): The biodiversity
measurement of the Taxon at the Site in the Study, in units of
Diversity_metric_unit.</li>
</ul>
<p><strong>Notes:</strong> When we refer to a “study” we typically refer
to it from the <code>SS</code> that identifies it. Referring to an
“extract” simply refers to a PREDICTS database release, either from 2016
or 2022 (or both). For further complete documentation see the SI in
Hudson et. al. (2017).</p>
</div>
<div id="notes" class="section level2">
<h2>Notes</h2>
<p>The <a href="https://data.nhm.ac.uk/about/download">NHM Data Portal
API</a> has no rate limits so be considerate with your requests. Make
sure you save the data somewhere, or use a tool like <a href="https://docs.ropensci.org/targets/index.html"><code>targets</code></a>
to save you from re-running workflows.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Hudson, Lawrence N., et al. “The PREDICTS database: a global database
of how local terrestrial biodiversity responds to human impacts.”
Ecology and evolution 4.24 (2014): 4701-4735.
&lt;doi.org/10.1002/ece3.1303&gt;.</p>
<p>Hudson, Lawrence N., et al. “The database of the PREDICTS (projecting
responses of ecological diversity in changing terrestrial systems)
project.” Ecology and evolution 7.1 (2017): 145-188
&lt;doi.org/10.1002/ece3.2579&gt;</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
